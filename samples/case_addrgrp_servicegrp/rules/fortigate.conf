config firewall address
    edit "SRC_IN"
        set subnet 10.50.0.0 255.255.255.0
    next
    edit "SRC_OUT"
        set subnet 10.51.0.0 255.255.255.0
    next
    edit "DST_IN"
        set subnet 172.50.0.0 255.255.255.0
    next
    edit "DST_OUT"
        set subnet 172.51.0.0 255.255.255.0
    next
end

config firewall addrgrp
    edit "AG_SRC_IN"
        set member "SRC_IN"
    next
    edit "AG_DST_IN"
        set member "DST_IN"
    next
end

config firewall service custom
    edit "tcp_1000-1002"
        set tcp-portrange 1000-1002
    next
    edit "tcp_8443"
        set tcp-portrange 8443
    next
    edit "udp_2000-2001"
        set udp-portrange 2000-2001
    next
    edit "udp_5353"
        set udp-portrange 5353
    next
    edit "tcp_8080"
        set tcp-portrange 8080
    next
    edit "udp_53"
        set udp-portrange 53
    next
    edit "tcp_3000-3002"
        set tcp-portrange 3000-3002
    next
    edit "udp_4000-4001"
        set udp-portrange 4000-4001
    next
    edit "TCP"
        set tcp-portrange 1-65535
    next
    edit "POP3"
        set tcp-portrange 110
    next
    edit "DCE-RPC"
        set tcp-portrange 135
    next
    edit "SAMBA"
        set tcp-portrange 445
    next
end

config firewall service group
    edit "SG_MAIN"
        set member "DNS"
        set member "SMTP"
        set member "tcp_8080"
        set member "udp_53"
        set member "tcp_3000-3002"
        set member "udp_4000-4001"
    next
    edit "SG_EXTRA"
        set member "tcp_1000-1002"
        set member "tcp_8443"
        set member "udp_2000-2001"
        set member "udp_5353"
        set member "TCP"
        set member "SMTP"
        set member "POP3"
        set member "DNS"
        set member "DCE-RPC"
        set member "SAMBA"
    next
end

config firewall policy
    edit 1
        set name "1"
        set srcaddr "AG_SRC_IN"
        set dstaddr "AG_DST_IN"
        set service "SG_MAIN"
        set schedule "always"
        set action accept
        set status enable
    next
    edit 2
        set name "2"
        set srcaddr "AG_SRC_IN"
        set dstaddr "DST_OUT"
        set service "ALL"
        set schedule "always"
        set action deny
        set status enable
    next
    edit 3
        set name "3"
        set srcaddr "SRC_OUT"
        set dstaddr "AG_DST_IN"
        set service "ALL"
        set schedule "always"
        set action deny
        set status enable
    next
    edit 4
        set name "4"
        set srcaddr "AG_SRC_IN"
        set dstaddr "AG_DST_IN"
        set service "SG_EXTRA"
        set schedule "always"
        set action accept
        set status disable
    next
end
